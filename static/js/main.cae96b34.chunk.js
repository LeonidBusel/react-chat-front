(this.webpackJsonpfront=this.webpackJsonpfront||[]).push([[0],{208:function(e,t,c){},273:function(e,t,c){},274:function(e,t,c){},341:function(e,t,c){},342:function(e,t,c){},343:function(e,t,c){},346:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c.n(n),s=c(12),r=c.n(s),o=c(63),i=c(50),l=c(25),j=c(97),u=c(32),b=c(354),m=c(352),d=c(351),O=c(353),f=c(197),h=c(350),p=(c(208),c(8)),x=m.a.Text,g=m.a.Title,k=function(e){var t=e.allUser;return Object(p.jsxs)("div",{className:"active-user-wrapper",children:[Object(p.jsx)(g,{level:3,children:"Active Users:"}),Object(p.jsx)(h.b,{dataSource:t,renderItem:function(e,t){var c=e.nickName,n=e.nickColor,a=e.clientId;return Object(p.jsx)(h.b.Item,{children:Object(p.jsx)(h.b.Item.Meta,{title:Object(p.jsxs)(x,{style:{color:n},children:[t+1,". ",c]})})},a)}})]})},v=c(188),y=c.n(v),N=(c(272),c(273),function(e){var t=e.onClose,c=e.color;return Object(p.jsx)("div",{className:"color-picker-wrapper",children:Object(p.jsx)(y.a,{animation:"slide-up",enableAlpha:!0,defaultColor:c,onClose:t})})}),C=(c(274),m.a.Text),I=O.a.TextArea,L=function(e){var t=e.allMsg,c=e.sendMsgHandle,a=Object(n.useRef)(null),s=d.a.useForm(),r=Object(j.a)(s,1)[0];return Object(n.useEffect)((function(){a.current.scrollIntoView()}),[t]),Object(p.jsxs)("div",{className:"chat-area-wrapper",children:[Object(p.jsxs)("div",{className:"chat-body",children:[Object(p.jsx)(h.b,{dataSource:t,renderItem:function(e){var t=e.nickName,c=e.nickColor,n=e.id,a=e.message,s=e.date;return Object(p.jsx)(h.b.Item,{children:Object(p.jsx)(h.b.Item.Meta,{title:Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(C,{style:{color:c},children:t})," ",Object(p.jsx)(C,{type:"secondary",children:s})]}),description:Object(p.jsx)(C,{children:a})})},n)}}),Object(p.jsx)("div",{className:"chat-body-end-fake",ref:a})]}),Object(p.jsxs)(d.a,{className:"msg-send-form",form:r,name:"message-form",layout:"inline",size:"medium",onFinish:function(e){r.resetFields(),c(e)},children:[Object(p.jsx)(d.a.Item,{name:"message",className:"text-area-wrapper",extra:"press ctrl + enter for send msg",children:Object(p.jsx)(I,{rows:2,placeholder:"Type msg...",required:!0,onKeyDown:function(e){!e.ctrlKey||10!=e.keyCode&&13!=e.keyCode||(r.submit(),e.preventDefault())}})}),Object(p.jsx)(d.a.Item,{children:Object(p.jsx)(f.a,{type:"primary",htmlType:"submit",children:"Send"})})]})]})},w=function(e){var t=e.path,c=e.exact,n=e.component;return Object(p.jsx)(l.a,{path:t,exact:c,component:n})},S=c(81),U=Object(S.b)({name:"login",initialState:{isLogin:!1,nickName:null,nickColor:null},reducers:{login:function(e,t){var c=t.payload;e.isLogin=!0,e.nickName=c.nickName,e.nickColor=c.nickColor},logout:function(e){e.isLogin=!1,e.nickName=null,e.nickColor=null}}}),M=U.actions,T=M.login,E=M.logout,A=U.reducer,J=(c(341),b.a.Header),F=b.a.Content,G=m.a.Title;var H,D=Object(i.b)((function(e){return{userLogin:e.userLogin}}),(function(e){return Object(u.b)({login:T},e)}))((function(e){var t=d.a.useForm(),c=Object(j.a)(t,1)[0],a=Object(n.useState)("#000"),s=Object(j.a)(a,2),r=s[0],o=s[1],i=Object(l.f)();Object(n.useEffect)((function(){e.userLogin.isLogin&&i.push("/chat")}),[e.userLogin.isLogin]);return Object(p.jsxs)(b.a,{className:"welcome-wrapper",children:[Object(p.jsx)(J,{children:Object(p.jsx)(G,{className:"title",children:"Welcome!"})}),Object(p.jsx)(F,{children:Object(p.jsxs)(d.a,{form:c,name:"login-form",layout:"inline",size:"medium",onFinish:function(t){e.login({nickName:t.nickname,nickColor:r})},children:[Object(p.jsx)(d.a.Item,{label:"Nick Name",name:"nickname",extra:"max 15 symbols",children:Object(p.jsx)(O.a,{placeholder:"Type your nickname...",maxLength:15,required:!0})}),Object(p.jsx)(d.a.Item,{label:"Nick Color",name:"color",children:Object(p.jsx)(N,{color:r,onClose:function(e){var t=e.color;o(t)}})}),Object(p.jsx)(d.a.Item,{children:Object(p.jsx)(f.a,{type:"primary",htmlType:"submit",children:"Entry"})})]})})]})})),_=c(348),q=c(349),z=Object(S.b)({name:"message",initialState:{isOpen:!1,msg:[],activeUser:[]},reducers:{open:function(e){e.isOpen=!0},activeUser:function(e,t){var c=t.payload;e.activeUser=c.slice()},allMsg:function(e,t){var c=t.payload;e.msg=c.slice()},close:function(e){e.isOpen=!1,e.msg=[],e.activeUser=[]}}}),K=z.actions,R=(K.open,K.activeUser),V=K.allMsg,W=K.close,B=z.reducer,P=function(e){var t,c=e.nickName,n=e.nickColor,a=e.msgAllCallback,s=e.activeUserCallback,r=e.logoutUserCallback,o=new WebSocket("wss://chat-nodejs-leonid.herokuapp.com/");return o.onopen=function(){console.log("websocket is connected..."),o.send(JSON.stringify({type:"LOGIN",nickName:c,nickColor:n})),t=setInterval((function(){return o.send(JSON.stringify({type:"PING"}))}),3e4)},o.onmessage=function(e){var t=JSON.parse(e.data);switch(console.log(t),t.type){case"ACTIVE_USER":s(t.activeUser);break;case"MSG_ALL":a(t.messages)}},o.onerror=function(e){console.log("socket error"),clearInterval(t),r()},o.onclose=function(){console.log("socket is close"),clearInterval(t),r()},o},Q=(c(342),b.a.Header),X=b.a.Content,Y=m.a.Title;var Z=Object(i.b)(null,(function(e){return Object(u.b)({logout:E,activeUser:R,allMsg:V,close:W},e)}))((function(e){var t=Object(l.f)(),c=Object(i.c)((function(e){return e.userLogin})),a=Object(i.c)((function(e){return e.message.msg})),s=Object(i.c)((function(e){return e.message.activeUser})),r=c.isLogin,j=c.nickName,u=c.nickColor;Object(n.useEffect)((function(){r?H=P({nickName:j,nickColor:u,msgAllCallback:m,activeUserCallback:d,logoutUserCallback:O}):t.push("/react-chat-front")}),[]);var m=function(t){e.allMsg(t)},d=function(t){e.activeUser(t)},O=function(){e.logout(),e.close(),1===H.readyState&&H.send(JSON.stringify({type:"LOGOUT"}))};return Object(n.useEffect)((function(){c&&!c.isLogin&&t.push("/")}),[c]),Object(n.useEffect)((function(){return function(){c.isLogin&&O()}}),[]),Object(p.jsxs)(b.a,{className:"chat-wrapper",children:[Object(p.jsx)(Q,{children:Object(p.jsx)(Y,{className:"title",children:"Global Chat!"})}),Object(p.jsxs)(X,{className:"chat-content-wrapper",children:[Object(p.jsx)(_.a,{children:Object(p.jsx)(o.b,{to:"/react-chat-front",children:"< back to welcome page"})}),Object(p.jsxs)(_.a,{gutter:24,children:[Object(p.jsx)(q.a,{span:16,children:Object(p.jsx)(L,{allMsg:a,sendMsgHandle:function(e){H.send(JSON.stringify({type:"SEND_MSG",message:e.message}))}})}),Object(p.jsx)(q.a,{span:8,children:Object(p.jsx)(k,{allUser:s})})]})]})]})})),$=function(){return Object(p.jsxs)(l.c,{children:[Object(p.jsx)(l.a,{path:"/",exact:!0,component:D}),Object(p.jsx)(l.a,{path:"/react-chat-front",exact:!0,component:D}),Object(p.jsx)(w,{path:"/chat",exact:!0,component:Z}),Object(p.jsx)(l.a,{path:"*",exact:!0,component:D})]})},ee={userLogin:A,message:B},te=Object(S.a)({reducer:ee});c(343),c(344);r.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(i.a,{store:te,children:Object(p.jsx)(o.a,{children:Object(p.jsx)($,{})})})}),document.getElementById("root"))}},[[346,1,2]]]);
//# sourceMappingURL=main.cae96b34.chunk.js.map